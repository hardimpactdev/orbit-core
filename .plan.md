# Horizon-Style Architecture Implementation Plan

## Goal
Make orbit-core a self-contained package that serves its own views and assets, turning shell apps (orbit-web, orbit-desktop) into empty wrappers.

## Current State
- **Blade views**: None exist (`resources/views/` is empty)
- **OrbitServiceProvider**: Has basic structure but missing Vite/view configuration
- **vite.config.ts**: Full custom config that needs simplification
- **public/**: Directory doesn't exist

---

## Implementation Steps

### 1. Create Blade View
**File**: `resources/views/app.blade.php`

Create the root Blade template with:
- Dark mode detection script (system preference based)
- Vite asset loading (`@vite`)
- Inertia integration (`@inertiaHead`, `@inertia`)

### 2. Update Service Provider
**File**: `src/OrbitServiceProvider.php`

Changes:
- Add `use Illuminate\Support\Facades\Vite;` import
- Add `configureVite()` method:
  - Set hot file path to `__DIR__.'/../public/hot'`
  - Set build directory to `vendor/orbit/build`
- Add `registerViews()` method:
  - Load views from `resources/views` with namespace `orbit`
  - Set Inertia root view to `orbit::app`
- Update `registerPublishing()`:
  - Add asset publishing from `public/build` to `public/vendor/orbit/build`
- Update `boot()` to call new methods in order:
  1. `configureVite()`
  2. `registerViews()`
  3. `registerCommands()`
  4. `registerMigrations()`
  5. `registerPublishing()`

### 3. Simplify Vite Config
**File**: `vite.config.ts`

Replace entire config with:
```ts
import { defineCraftConfig } from '@hardimpactdev/craft-ui/vite';

export default defineCraftConfig();
```

**Note**: Ensure `@hardimpactdev/craft-ui` package provides this function and handles the Vue/Tailwind/Laravel plugins internally.

### 4. Create public/.gitignore
**File**: `public/.gitignore`

Contents:
```
hot
build/
```

This ignores dev server hot file and production build artifacts.

---

## Verification Checklist

After implementation:
- [ ] `bun run dev` in orbit-core creates `public/hot`
- [ ] Visit orbit-web.ccc with HMR working
- [ ] `bun run build` creates `public/build/`
- [ ] `php artisan vendor:publish --tag=orbit-assets` works in shell apps

---

## Notes

- The `defineCraftConfig()` function from craft-ui needs to be verified/created if it doesn't exist
- Shell apps will need their own Blade views removed (handled separately in orbit-web)
